{% extends "laboratory/assets/base_qc.html" %}

{% block content %}
<div class="max-w-4xl mx-auto mt-8 px-4 sm:px-6 lg:px-8">
  <!-- Header -->
  <div class="mb-8">
    <h1 class="text-2xl font-bold text-navy-800 mb-2">
      {% if create %}Create New QC Lot{% else %}Edit QC Lot{% endif %}
    </h1>
    <p class="text-gray-600">Manage quality control specifications for laboratory tests</p>
  </div>

  <!-- Form Card -->
  <div class="bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden">
    <div class="bg-navy-700 px-6 py-4">
      <h2 class="text-lg font-semibold text-white">
        <i class="fas fa-vial mr-2 text-gold-400"></i>
        QC Lot Details
      </h2>
    </div>

    <form method="post" class="p-6 space-y-6">
      {% csrf_token %}
      
      <!-- Form Errors -->
      {% if form.non_field_errors %}
      <div class="bg-red-50 border border-red-200 rounded-lg p-4">
        <div class="flex items-center">
          <i class="fas fa-exclamation-circle text-red-500 mr-3"></i>
          <div class="text-red-700 text-sm">
            {{ form.non_field_errors }}
          </div>
        </div>
      </div>
      {% endif %}

      <!-- Test Field -->
      <div class="form-group">
        <label class="block text-sm font-semibold text-navy-700 mb-2">
          <i class="fas fa-flask mr-2 text-navy-600"></i>
          Test
        </label>
        <div class="relative">
          {{ form.test }}
          <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
            <i class="fas fa-chevron-down text-gray-400"></i>
          </div>
        </div>
      </div>

      <!-- Level and Lot Number -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="form-group">
          <label class="block text-sm font-semibold text-navy-700 mb-2">
            <i class="fas fa-layer-group mr-2 text-navy-600"></i>
            Level
          </label>
          {{ form.level }}
        </div>
        <div class="form-group">
          <label class="block text-sm font-semibold text-navy-700 mb-2">
            <i class="fas fa-barcode mr-2 text-navy-600"></i>
            Lot Number
          </label>
          {{ form.level }}
        </div>
      </div>

      <!-- Manufacturer -->
      <div class="form-group">
        <label class="block text-sm font-semibold text-navy-700 mb-2">
          <i class="fas fa-industry mr-2 text-navy-600"></i>
          Manufacturer
        </label>
        {{ form.manufacturer }}
      </div>

      <!-- Target Values Section -->
      <div class="border-t border-gray-200 pt-6">
        <h3 class="text-md font-semibold text-navy-800 mb-4 flex items-center">
          <i class="fas fa-bullseye mr-2 text-gold-500"></i>
          Target Values & Specifications
        </h3>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div class="form-group">
            <label class="block text-sm font-semibold text-navy-700 mb-2">Target Value</label>
            {{ form.target_value }}
          </div>
          <div class="form-group">
            <label class="block text-sm font-semibold text-navy-700 mb-2">Standard Deviation</label>
            {{ form.sd }}
          </div>
          <div class="form-group">
            <label class="block text-sm font-semibold text-navy-700 mb-2">Units</label>
            {{ form.units }}
          </div>
        </div>

        <!-- Explicit Range -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
          <div class="form-group">
            <label class="block text-sm font-semibold text-red-600 mb-2">
              <i class="fas fa-arrow-down mr-2"></i>
              Explicit Low
            </label>
            {{ form.explicit_low }}
          </div>
          <div class="form-group">
            <label class="block text-sm font-semibold text-red-600 mb-2">
              <i class="fas fa-arrow-up mr-2"></i>
              Explicit High
            </label>
            {{ form.explicit_high }}
          </div>
        </div>
      </div>

      <!-- Dates Section -->
      <div class="border-t border-gray-200 pt-6">
        <h3 class="text-md font-semibold text-navy-800 mb-4 flex items-center">
          <i class="fas fa-calendar-alt mr-2 text-gold-500"></i>
          Date Information
        </h3>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div class="form-group">
            <label class="block text-sm font-semibold text-navy-700 mb-2">Received Date</label>
            <div class="relative">
              {{ form.received_date }}
              <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                <i class="fas fa-calendar text-gray-400"></i>
              </div>
            </div>
          </div>
          <div class="form-group">
            <label class="block text-sm font-semibold text-navy-700 mb-2">Expiry Date</label>
            <div class="relative">
              {{ form.expiry_date }}
              <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                <i class="fas fa-calendar-times text-gray-400"></i>
              </div>
            </div>
          </div>
          <div class="form-group">
            <label class="block text-sm font-semibold text-navy-700 mb-2">Opened Date</label>
            <div class="relative">
              {{ form.opened_date }}
              <div class="absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none">
                <i class="fas fa-calendar-check text-gray-400"></i>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Active Status -->
      <div class="border-t border-gray-200 pt-6">
        <div class="flex items-center">
          <label class="inline-flex items-center cursor-pointer">
            {{ form.is_active }}
            <span class="ml-3 text-sm font-semibold text-navy-700">
              <i class="fas fa-check-circle mr-2 text-green-500"></i>
              Mark as active QC lot
            </span>
          </label>
        </div>
        <p class="text-xs text-gray-500 mt-2 ml-9">Active lots will be available for daily QC testing</p>
      </div>

      <!-- Action Buttons -->
      <div class="border-t border-gray-200 pt-6 flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-4">
        <a href="{% url 'labs:qclot_list' %}" class="px-6 py-2.5 border border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-50 transition duration-200 text-center">
          <i class="fas fa-times mr-2"></i>
          Cancel
        </a>
        <button type="submit" class="px-6 py-2.5 bg-blue-800 text-white rounded-lg font-semibold shadow-md flex items-center justify-center">
          <i class="fas fa-save mr-2"></i>
          Save QC Lot
        </button>
      </div>
    </form>
  </div>
</div>

<style>
.form-group input, .form-group select {
  width: 100%;
  padding: 0.75rem 1rem;
  border: 2px solid #e5e7eb;
  border-radius: 0.5rem;
  font-size: 0.875rem;
  transition: all 0.2s ease;
}

.form-group input:focus, .form-group select:focus {
  outline: none;
  border-color: #1e3a8a;
  box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
}

/* Custom checkbox styling */
input[type="checkbox"] {
  width: 1.25rem;
  height: 1.25rem;
  border-radius: 0.375rem;
  border: 2px solid #d1d5db;
  appearance: none;
  -webkit-appearance: none;
  cursor: pointer;
  position: relative;
}

input[type="checkbox"]:checked {
  background-color: #1e3a8a;
  border-color: #1e3a8a;
}

input[type="checkbox"]:checked::before {
  content: "âœ“";
  position: absolute;
  color: white;
  font-size: 0.75rem;
  font-weight: bold;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}
</style>
{% endblock %}